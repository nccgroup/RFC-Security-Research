#!/usr/bin/python3

# Matt Lewis, NCC Group 2020
#
# use this script against the output from vulnparse.py to
# get the CWEs of CVEs of interest, and map them to their
# descriptions.

mappings = {}

# CWE-Defs is the mapping of CWE-IDs and their descriptions
f = open('CWE-Defs', 'r')
for line in f:
    tok = line.rstrip().split(',')
    mappings[tok[0]] = tok[1]

f.close()

counts = {}

# the filename below is whatever the output from vulnparse.py was named.
# IPP.txt in this example
f = open('IPP.txt', 'r')
for line in f:
    tok = line.rstrip().split(',')

    if tok[1] not in counts:
        counts[tok[1]] = 1
    else:
        counts[tok[1]] += 1


for key, val in counts.items():
    if key in mappings:
        print(key, mappings[key], val)
    else:
        print(key, val)

